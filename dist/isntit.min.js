/*!
 * Isntit - a simple javascript validation library
 * version: 0.0.2
 * (c) 2016 stoempsaucisse
 * Released under the MIT License.
 */

!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.Isntit=t()}(this,function(){"use strict";function e(){}function t(e,t){return s.call(e,t)}function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}function n(e,t){return this instanceof n?(this.options=Object.assign(o,t||{}),this.rules=e||{},this.config=i,void(this.errors={})):(a("`Isntit([rules [, options]])` is a constructor and should be called with the `new` keyword."),new n(e,t))}var i={bitMasks:{string:1,number:2,boolean:4,null:8,date:16,regexp:32,array:64,set:128,object:256,rest:1<<30},checkersSteps:["before","during"],confirmationRE:/(.+)_confirmation$/,comparators:{"==":function(e,t){return e==t},"===":function(e,t){return e===t},"!=":function(e,t){return e!=t},"!==":function(e,t){return e!==t},">":function(e,t){return e>t},">=":function(e,t){return e>=t},"<":function(e,t){return e<t},"<=":function(e,t){return e<=t},get equalTo(){return delete this.equalTo,this.equalTo=this["=="]},get notEqualTo(){return delete this.notEqualTo,this.notEqualTo=this["!="]},get greaterThan(){return delete this.greaterThan,this.greaterThan=this[">"]},get greaterThanOrEqualTo(){return delete this.greaterThanOrEqualTo,this.greaterThanOrEqualTo=this[">="]},get lessThan(){return delete this.lessThan,this.lessThan=this["<"]},get lessThanOrEqualTo(){return delete this.lessThanOrEqualTo,this.lessThanOrEqualTo=this["<="]}},emailRE:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,emptyStringRE:/^[\s\t\n\r]+$/,emptyValues:[null,void 0,"undefined"],equalityComparators:["==","===","!=","!==","equalTo","notEqualTo"],messages:{confirms:"should be sames as %{field}",required:"is required",email:"is not a valid email",format:"",length:function(){var e=this,t=e.ruleSet.length;return t.is?"must be exactly %{is} characters long":t.min&&t.max?"must be between %{min} and %{max} characters long":t.min?"must be minimum %{min} characters long":t.max?"must be maximum %{min} characters long":void 0},numeric:{onlyInteger:"must be an integer",noStrings:"strings are not allowed",equalTo:"must be equal to %{equalTo}",notEqualTo:"must not be equal to %{notEqualTo}",greaterThan:"must be greater than %{greaterThan}",greaterThanOrEqualTo:"must be greater than or equal to %{greaterThanOrEqualTo}",lessThan:"must be less than %{lessThan}",lessThanOrEqualTo:"must be less than or equal to %{lessThanOrEqualTo}"},notValid:"is not valid."},noLabelChar:"^"},a=e,s=Object.prototype.hasOwnProperty,o={silent:!1,devtools:!1,fullMessages:!1,capitalize:!0},u=function(e,t,r){var n,i=this;return n=e.ruleSet[t].message||i.config.messages[t]||i.config.messages.notValid,n instanceof Object&&"function"!=typeof n&&(n=n[r]||i.config.messages.notValid),"function"==typeof n?n.call(e):n};return n.prototype.currentContext={},n.prototype.config=i,n.prototype.checkers={before:{confirms:{validate:function(e,t){var r=this,n=t.data,i=t.ruleSet.confirms;return i.otherValue=n[i.field],result=i.strict?e===i.otherValue:e==i.otherValue,!!result||u.call(r,t,"confirms")}},required:{validate:function(e,t){var r=this;return!n.isEmpty(e)||u.call(r,t,"required")}}},during:{email:{validate:function(e,t){n.isString(e);var r=this;return!!i.emailRE.test(e)||u.call(r,t,"email")}},format:{validate:function(e,t){n.isOfType(["string","number"],e);var r=this,i=t.ruleSet,a=i.format instanceof RegExp?i.format:i.format.pattern;return!a.test(e)||u.call(r,t,"format")}},length:{validate:function(e,t){n.isOfType(["string","number","array"],e);var r=this,i=[],a=!0,s=t.ruleSet.length;if(e+="",s.min&&!(e.length>=s.min)){a=!1;var o=u.call(r,t,"length","min");o&&i.push(o)}if(s.max&&!(e.length<=s.max)){a=!1;var o=u.call(r,t,"length","max");o&&i.push(o)}if(s.is&&e.length!=s.is){a=!1;var o=u.call(r,t,"length","is");o&&i.push(o)}return!!a||(i.join(" and ")||u.call(r,t,"length"))}},numeric:{validate:function(e,t){n.isOfType(["string","number"],e);var r=this,i=[],a=t.ruleSet.numeric;if("string"==typeof e){if(a.noStrings===!0)return u.call(r,t,"numeric","noStrings")||u.call(r,t,"numeric");if(""===e)return!0;e=+e}if(!isFinite(e)||null===e)return u.call(r,t,"numeric","notValid")||u.call(r,t,"numeric");var s=!0,i=[];if(a.onlyInteger&&e%1!==0){s=!1;var o=u.call(r,t,"numeric","onlyInteger");o&&i.push(o)}for(var l in a)if("onlyInteger"!=l&&"noStrings"!=l&&!r.compare(e,l,a[l])){s=!1;var o=u.call(r,t,"numeric",l);o&&i.push(o)}return!!s||(i.join(" and ")||u.call(r,t,"numeric"))}}}},n.getTypeBit=function(e){switch(typeof e){case"string":return i.bitMasks.string;case"number":return i.bitMasks.number;case"boolean":return i.bitMasks.boolean;case"object":switch(!0){case null===e:return i.bitMasks.null;case e instanceof Date:return i.bitMasks.date;case e instanceof RegExp:return i.bitMasks.regexp;case e instanceof Array:case e instanceof Map:case e instanceof WeakMap:return i.bitMasks.array;case e instanceof Set:case e instanceof WeakSet:return i.bitMasks.set;default:return i.bitMasks.object}default:return i.bitMasks.rest}},n.isEmpty=function(e){var t=typeof e;if(("string"===t||"array"===t)&&0===e.length)return!0;if("string"===t&&i.emptyStringRE.test(e))return!0;if(e instanceof Object&&0===Object.keys(e).length)return!0;for(var r=0;r<i.emptyValues.length;r++)if(e===i.emptyValues[r])return!0;return!1},n.isOfType=function(e,t,r){if(r="undefined"==typeof r||r,n.getTypeBit(e)===i.bitMasks.array){var s=!1;e.forEach(function(e){s=s||n.isOfType(e,t,!1)}),e=e.join(", ")}else var s=n.getTypeBit(t)===i.bitMasks[e];return!s&&r&&a("Value is not of type "+e+", given: "+typeof t),s},n.isNumber=function(e,t){return n.isOfType("number",e,t)},n.isString=function(e,t){return n.isOfType("string",e,t)},n.printf=function(e,t){var t=t;return e.replace(/\%\{([\w\d_\.]+)\}/g,function(r,n){return"undefined"!=typeof t[n]?t[n]:(a("There is no replacement for "+r+" in "+e,t),r)})},n.prototype.validate=function(e,a){var s=this,a=a||this.rules;this.errors={};for(var o in e)if(t(e,o)){var u=e[o];if(a[o]===!0){var l=o.match(i.confirmationRE);l&&(a[o]={confirms:{field:l[1]}})}for(var c=0;c<i.checkersSteps.length;c++){var f=i.checkersSteps[c];for(var h in a[o]){var m={value:u,fieldName:o,data:e,ruleName:h,ruleSet:a[o],rules:a,step:f},p=s.checkers[f][h];if("undefined"!=typeof p){var g=p.validate.call(s,u,m);if(g!==!0){t(s.errors,o)||(s.errors[o]=[]);var d={value:u,label:o};Object.assign(d,m.ruleSet[h]);var b=g.charAt(0)===i.noLabelChar,y=a[o][h].fullMessage||s.options.fullMessages;y&&!b&&(g="%{label} "+g),b&&(g=g.substr(1)),g=n.printf(g,d);var v=a[o][h].capitalize||s.options.capitalize;v&&(g=r(g)),s.errors[o].push(g)}}}if("undefined"!=typeof s.errors[o])break}}return this.errors},n.prototype.compare=function(e,r,s){return t(i.comparators,r)||a("Unknown comparator: "+r),n.getTypeBit(e)!==n.getTypeBit(s)&&a("You are comparing values with different types: "+e+" and "+s),this.config.comparators[r](e,s)},n.prototype.getMessages=function(){return this.errors},n.prototype.registerChecker=function(e,r,n,s){var o=this;if("function"==typeof e||t(e,"validate")){if(n=n||"during","undefined"==typeof r)throw new Error("When registering a `callback` as checker, you must provide a `name` for it: registerChecker(callable, name[, step[, checkersSteps]])");t(this.checkers,n)||(this.checkers[n]={},"undefined"==typeof s&&i.checkersSteps.push(n)),t(e,"validate")?this.checkers[n][r]=e:this.checkers[n][r]={validate:e}}else{arguments.length>3&&a("Instance methode registerChecker() signature is:\n(object[, step[, checkersSteps]]), supplemental arguments will be ignored.",Array.from(arguments));for(var u in e)if(s=n,i.checkersSteps.indexOf(u)!==-1){n=u;for(var r in e[n])o.registerChecker(e[n][r],r,n,s)}else n=r,o.registerChecker(e[u],u,n,s)}},n});